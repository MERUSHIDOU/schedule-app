# Claude Code ルール

このファイルはClaude Codeの動作ルールを定義します。

## ブランチとPRのワークフロー

- **常に新しいブランチで作業する**: すべての変更（機能追加、バグ修正、ドキュメント変更など）は新しいブランチで作業してください
- **1ブランチ1修正の原則**: 各修正は必ず別のブランチで作業してください
  - 既存のブランチに別の修正を追加してはいけません
  - 新しい修正を行う場合は、必ず最新のベースブランチから新しいブランチを作成してください
- **すべてPRで提出**: 変更は直接メインブランチにプッシュせず、必ずPull Requestとして提出してください

## ログファイルの参照禁止

**`.claude/logs/` ディレクトリ内のファイルは、ユーザーから明示的に指示されない限り、絶対に参照してはならない。**

- ログファイルを読み取る（Read）ことは禁止
- ログファイルの内容を検索する（Grep）ことは禁止
- ログファイルの存在を確認する以外の目的でアクセスすることは禁止

### 許可される操作
- ログファイルへの**書き込み**（会話の記録）
- ユーザーが**明示的に**「ログを確認して」「過去の会話を見て」等と指示した場合のみ参照可能

### 理由
各会話は独立して扱われるべきであり、過去のログに基づいた推測や前提を持ち込まないことで、ユーザーの意図を正確に理解することを目的とする。

## ログ記録の義務化

**すべての会話と指示について、必ずログを記録すること。これは必須の動作である。**

### ログファイルの場所
- `.claude/logs/YYYY-MM-DD_conversation.md`
- 日付ごとに1つのログファイルを作成
- 同じ日に複数の会話がある場合は同じファイルに追記

### ログに記録すべき内容
各会話/指示について、以下を**必ず**記録する：

1. **タイムスタンプ**: 会話の開始時刻
2. **ユーザーのリクエスト**: ユーザーが何を求めたか（原文を含む）
3. **理解した意図**: Claudeがどう解釈したか
4. **実施した操作**: 実際に行った作業の詳細
   - 使用したツール
   - 変更したファイル
   - 実行したコマンド
5. **判断の根拠**: なぜその方法を選択したか
6. **結果**: 操作の結果と成否
7. **次のアクション**: 残っている作業や推奨される次のステップ

### ログの形式
```markdown
## [YYYY-MM-DD HH:MM] 会話タイトル

### ユーザーのリクエスト
[ユーザーの要求内容]

### 理解した意図
[Claudeの解釈]

### 実施した操作
- [操作1]
- [操作2]

### 判断の根拠
[選択した方法とその理由]

### 結果
[操作の結果]

### 次のアクション
[残作業や推奨事項]

---
```

### ログ記録のタイミング
- 会話が完了した時点で記録
- 長い会話の場合は、主要な操作の後に随時記録
- エラーが発生した場合は即座に記録

### ログファイルの管理
- ログファイルはgit管理対象外（`.gitignore`に追加済み）
- ローカル環境でのみ保持
- プライバシー情報を含む可能性があるため公開しない
