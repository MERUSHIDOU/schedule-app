---
model: haiku
---

# Log Conversation Skill

会話の内容を `.claude/logs/YYYY-MM-DD_conversation.md` に記録します。

## 目的

このスキルは、Claude Codeでの会話履歴を構造化されたマークダウン形式でログファイルに記録します。CLAUDE.mdの「ログ記録の義務化」要件に従って動作します。

## 実行タイミング

- 会話が完了した時点で必ず実行
- 長い会話の場合は、主要な操作の後に随時実行
- エラーが発生した場合は即座に実行

## Instructions

以下の手順で会話内容を記録してください：

### 1. 日付とログファイルパスの決定

```
日付: YYYY-MM-DD形式（例: 2026-01-17）
ログファイルパス: .claude/logs/YYYY-MM-DD_conversation.md
```

### 2. 既存ログの確認

- ログファイルが既に存在する場合は、**必ずReadツールで読み込む**
- 既存の内容を**絶対に上書きしない**
- 末尾に新しいセッションを追記する

### 3. 会話内容の抽出

直前の会話から以下の情報を抽出してください：

- **ユーザーのリクエスト**: ユーザーが何を求めたか
- **理解した意図**: あなた（Claude）がどう解釈したか
- **実施した操作**: 実際に行った作業の詳細（ファイル編集、コマンド実行など）
- **判断の根拠**: なぜその方法を選択したか
- **結果**: 操作の結果と成否

### 4. ログフォーマット

以下の形式で記録してください：

```markdown
---

## セッションN: <簡潔なタイトル>

### タイムスタンプ
YYYY-MM-DD HH:MM頃

### ユーザーのリクエスト
<ユーザーの質問や指示を箇条書きで>

### 理解した意図
<Claudeの理解と解釈>

### 実施した操作

#### 1. <操作名>
**変更内容**:
- 具体的な変更点

**ファイル**:
- 変更したファイルのパス

#### 2. <次の操作>
...

### 判断の根拠

#### なぜ<アプローチ名>を選択したか
- 理由1
- 理由2

### 結果

#### 成功した点
✅ 項目1
✅ 項目2

#### 技術的な課題
- 課題があれば記載

### 備考
- 補足事項があれば記載
```

### 5. ファイルへの書き込み

- **既存ファイルがある場合**: Readで読み込んでから末尾に追記
- **新規ファイルの場合**: 以下のヘッダーを追加

```markdown
# 会話ログ - YYYY-MM-DD

<セッション内容>
```

## 重要な注意事項

1. **上書き厳禁**: 既存のログファイルを絶対に上書きしない
2. **必ずRead**: 既存ファイルへの追記前に必ずReadツールで内容を確認
3. **完全な記録**: タイムスタンプ、リクエスト、操作、根拠、結果の全てを記録
4. **日本語で記録**: すべてのログは日本語で記述

## 実行例

```
ユーザー: /log-conversation

Claude:
1. 現在の日付を確認: 2026-01-17
2. ログファイル: .claude/logs/2026-01-17_conversation.md
3. Readツールで既存内容を確認
4. 会話内容を抽出して整形
5. 末尾に新しいセッションを追記
6. Writeツールで保存

ログを記録しました: .claude/logs/2026-01-17_conversation.md
```

## トラブルシューティング

- ログディレクトリが存在しない場合は自動作成
- 既存ファイルの読み込みに失敗した場合は新規作成
- タイムスタンプは実際の会話時刻に近い値を使用
